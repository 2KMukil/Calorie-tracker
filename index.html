
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Calorie Tracker</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; max-width: 600px; margin: auto; background: #f9f9f9; }
    h1 { text-align: center; }
    input, button { width: 100%; padding: 10px; margin: 5px 0; }
    ul { list-style: none; padding: 0; }
    li { padding: 8px; border-bottom: 1px solid #ccc; }
    .total { font-weight: bold; margin-top: 20px; text-align: center; }
    canvas { margin-top: 30px; }
  </style>
</head>
<body>
  <h1>Calorie Tracker</h1>
  <input type="text" id="foodInput" placeholder="Enter food (e.g., 1 banana)" />
  <button onclick="addFood()">Add Food</button>
  <ul id="foodList"></ul>
  <div class="total">Total Calories Today: <span id="totalCalories">0</span></div>
  <canvas id="calorieChart" width="400" height="200"></canvas>

  <script>
    const APP_ID = '6427e520'; 
    const API_KEY = 'ac6a9f2f37a1836edbd924374b40ab6e'; 

    const today = new Date().toISOString().split('T')[0];
    let history = JSON.parse(localStorage.getItem('calorieHistory')) || {};
    if (!history[today]) history[today] = [];

    function updateList() {
      const list = document.getElementById('foodList');
      const total = document.getElementById('totalCalories');
      list.innerHTML = '';
      let totalCals = 0;

      history[today].forEach(item => {
        const li = document.createElement('li');
        li.textContent = `${item.name} - ${item.calories.toFixed(2)} cal`;
        list.appendChild(li);
        totalCals += item.calories;
      });

      total.textContent = totalCals.toFixed(2);
      localStorage.setItem('calorieHistory', JSON.stringify(history));
      updateChart();
    }

    async function addFood() {
      const food = document.getElementById('foodInput').value.trim();
      if (!food) return;

      const response = await fetch('https://trackapi.nutritionix.com/v2/natural/nutrients', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'x-app-id': 'APP_ID',
          'x-app-key': 'API_KEY',
          'x-remote-user-id': '0'
        },
        body: JSON.stringify({ query: food })
      });

      const data = await response.json();
      if (data.foods && data.foods.length > 0) {
        const item = data.foods[0];
        history[today].push({ name: item.food_name, calories: item.nf_calories });
        document.getElementById('foodInput').value = '';
        updateList();
      } else {
        alert('Food not found!');
      }
    }

    function updateChart() {
      const ctx = document.getElementById('calorieChart').getContext('2d');
      const labels = Object.keys(history).sort();
      const data = labels.map(date => history[date].reduce((sum, item) => sum + item.calories, 0));

      if (window.calorieChart) window.calorieChart.destroy();
      window.calorieChart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: labels,
          datasets: [{
            label: 'Calories per Day',
            data: data,
            backgroundColor: 'rgba(75, 192, 192, 0.6)'
          }]
        },
        options: {
          responsive: true,
          scales: {
            y: { beginAtZero: true }
          }
        }
      });
    }

    updateList();
  </script>
</body>
</html>
